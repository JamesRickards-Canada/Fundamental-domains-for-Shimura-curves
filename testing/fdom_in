\r fdom;

\\Geometry
hdiscarea(2)
hdiscarea(11)

hdiscradius(100)
hdiscradius(10^6)

hdist(I, 2*I+10)
hdist(0.2+I/4, 5*I-11.2)
hdist(-1, 2) \\Error

hdist_ud(0.0123+I/2, -0.4)
hdist_ud(0.999*I, 0.999)
hdist_ud(0, 1) \\Error

M1=[4, 5;I, 2];
M2=[0, 3;1, 4];
mat_eval(M1, oo)
mat_eval(M1, -oo)
mat_eval(M1, I+2)
mat_eval(M2, oo)
mat_eval(M2, -4.5)

c1=[I, 2, 0];\\Centred at I, radius 2
c2=[1, 1, 2, 1+I, 0, Pi/2, 1, 0];\\Centred at 1, radius 1, from 0 to 1+I
c3=[0, 1, I, (1+I)/sqrt(2), Pi/2, Pi/4, -1, 0];\\Centred at 0, radius1, from (1+I)/sqrt(2) to I (the long way around).
mobius(M1, c1)
mobius(M2, c1)
mobius(M1, c2)
mobius(M1, c3)
l1=[1, I, 1];\\Line slope 1 thru I
l2=[oo, 11.5, 1];\\Vertical line thru x=11.5
mobius(M1, l1)
mobius(M2, l1)
mobius(M1, l2)
mobius(M2, l2)
mobius([2, -1;-1, 1],[7/8, 1/8, 0])	
l3=[1, I, I, 5+6*I, 0, 0, 1, 1];
l4=[1, I, I, 5+6*I, 0, 0, -1, 1];
l5=[3, 0, oo, 1+3*I, 0, 1, 0, 1];
l6=[3, 0, oo, 1+3*I, 0, -1, 0, 1];
mobius(M1, l3)
mobius(M2, l3)
mobius(M1, l4)
mobius(M2, l4)
mobius(M1, l5)
mobius(M2, l5)
mobius(M1, l6)
mobius(M2, l6)
mobius(2, [0, 1, 0]) \\Error

rdists=vector(50, i, random(15)+1);
rpoints=vector(50, i, randompoint_ud(rdists[i]));
rpointpass=1;
for(i=1, 50, if(hdist_ud(0, rpoints[i])>rdists[i],rpointpass=0));
if(rpointpass==1, print("Pass random points test"), print("Fail random points test"));


